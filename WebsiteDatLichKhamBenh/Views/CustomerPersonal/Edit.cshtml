@model WebsiteDatLichKhamBenh.Models.BenhNhan

@{
    ViewBag.Title = "Chỉnh Sửa Thông Tin Bệnh Nhân";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
        margin: 0;
        padding: 0;
    }

    .container {
        display: flex;
        padding: 20px;
    }

    .sidebar {
        width: 25%;
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        margin-right: 20px;
    }

        .sidebar h2 {
            color: #4CAF50;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .sidebar p, .sidebar a {
            font-size: 18px;
            color: #333;
            margin: 10px 0;
            text-decoration: none;
        }

            .sidebar p.active {
                font-weight: bold;
                font-size: 20px;
                color: #4CAF50;
            }

    .content {
        width: 75%;
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

        .content h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
        }

    .form-control {
        width: 100%;
        padding: 8px;
        margin: 5px 0 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    .edit-button {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 20px;
    }

        .edit-button .cancel-button {
            background-color: #f44336;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
        }

            .edit-button .cancel-button:hover {
                background-color: #d32f2f;
            }

        .edit-button button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

            .edit-button button:hover {
                background-color: #45a049;
            }
</style>

<div class="container">
    <div class="sidebar">
        <h2>Menu</h2>
        <p class="active">Thông tin bệnh nhân</p>
        <a href="@Url.Action("Index", "CustomerHistory")"><p>Lịch sử đặt lịch</p></a>
    </div>

    <div class="content">
        <h2>CHỈNH SỬA THÔNG TIN BỆNH NHÂN</h2>
        @using (Html.BeginForm("Edit", "CustomerPersonal", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(model => model.idBenhNhan)

    <div class="info">
        <p>
            <span>Họ và tên:</span>
            @Html.TextBoxFor(model => model.tenBenhNhan, new { @class = "form-control" })
        </p>
        <p>
            <span>Ngày sinh:</span>
            @Html.TextBoxFor(model => model.ngaySinh, "{0:yyyy-MM-dd}", new { @class = "form-control", type = "date" })
        </p>
        <p>
            <span>SĐT:</span>
            @Html.TextBoxFor(model => model.SDT, new { @class = "form-control" })
        </p>
        <p>
            <span>Email:</span>
            @Html.TextBoxFor(model => model.Email, new { @class = "form-control" })
        </p>
        <p>
            <span>Giới tính:</span>
            @Html.DropDownListFor(model => model.GioiTinh, new SelectList(new[] { "Nam", "Nữ" }), new { @class = "form-control" })
        </p>

        <!-- Dropdown cho Tiền sử bệnh án với lựa chọn mặc định trống -->
        <p>
            <span>Tiền sử bệnh án:</span>
            @Html.DropDownListFor(model => model.tienSuBenh, new SelectList(new[] {
                "",
                "Không có",
                "Tăng huyết áp",
                "Đái tháo đường type 2",
                "Bệnh tim mạch",
                "Hen phế quản",
                "Viêm gan B",
                "Bệnh phổi tắc nghẽn mạn tính",
                "Bệnh dạ dày",
                "Rối loạn lo âu",
                "Bệnh tiểu đường thai kỳ",
                "Bệnh suy thận mạn",
                "Khác..."
            }), new { @class = "form-control", id = "tienSuBenh", onchange = "toggleInputField(this, 'customTienSuBenh')" })
            <!-- Trường nhập ẩn để người dùng nhập khi chọn "Khác..." -->
            <input type="text" id="customTienSuBenh" name="customTienSuBenh" class="form-control" placeholder="Nhập Tiền sử bệnh án khác..." style="display:none; margin-top:5px;" />
        </p>

        <!-- Dropdown cho Dị ứng với lựa chọn mặc định trống -->
        <p>
            <span>Dị ứng:</span>
            @Html.DropDownListFor(model => model.DiUng, new SelectList(new[] {
                "",
                "Không có",
                "Phấn hoa",
                "Đậu phộng",
                "Hải sản",
                "Sữa",
                "Trứng",
                "Kháng sinh penicillin",
                "Nọc độc côn trùng",
                "Thực phẩm chứa gluten",
                "Thuốc giảm đau NSAID",
                "Mạt bụi nhà",
                "Khác..."
            }), new { @class = "form-control", id = "diUng", onchange = "toggleInputField(this, 'customDiUng')" })
            <!-- Trường nhập ẩn để người dùng nhập khi chọn "Khác..." -->
            <input type="text" id="customDiUng" name="customDiUng" class="form-control" placeholder="Nhập dị ứng khác..." style="display:none; margin-top:5px;" />
        </p>

    </div>

            <div class="edit-button">
                <button type="submit" onclick="return validateForm()">Lưu</button>
                <a href="@Url.Action("Index", "CustomerPersonal")" class="cancel-button">Hủy</a>
            </div>
        }
    </div>
</div>

<script>
    function toggleInputField(dropdown, inputId) {
        var inputField = document.getElementById(inputId);
        if (dropdown.value === "Khác...") {
            inputField.style.display = "block"; // Hiển thị trường nhập nếu chọn "Khác..."
        } else {
            inputField.style.display = "none"; // Ẩn trường nhập nếu chọn mục khác
            inputField.value = ""; // Xóa nội dung của trường nhập
        }
    }

    function validateForm() {
        var tienSuBenh = document.getElementById("tienSuBenh").value;
        var diUng = document.getElementById("diUng").value;
        var customTienSuBenh = document.getElementById("customTienSuBenh").value.trim();
        var customDiUng = document.getElementById("customDiUng").value.trim();

        // Kiểm tra nếu cả hai đều không chọn và không có nhập
        if ((tienSuBenh === "" || (tienSuBenh === "Khác..." && customTienSuBenh === "")) ||
            (diUng === "" || (diUng === "Khác..." && customDiUng === ""))) {
            alert("Vui lòng chọn hoặc nhập thông tin cho Tiền sử bệnh án và Dị ứng.");
            return false; // Ngăn gửi biểu mẫu nếu chưa nhập đủ
        }

        return true; // Cho phép gửi biểu mẫu nếu đã nhập đủ
    }
</script>



